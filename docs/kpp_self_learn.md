# KPP自己学習モジュール (`kpp_self_learn.rs`)

このモジュールは、KPP評価モデルをトレーニングするための自己対局学習メカニズムを実装しています。AIは自己対局を行い、そのゲームの結果を使用してモデルの重みを改善します。

## 主な機能

*   **自己対局:** AIは自己対局によって独自のトレーニングデータを生成します。これにより、自身の誤りから学び、新しい戦略を発見できます。
*   **並列データ生成:** このモジュールはRayonライブラリを使用してトレーニングデータを並列で生成し、学習プロセスを大幅に高速化します。
*   **交差エントロピー損失:** モデルは、分類モデルのトレーニングにおける標準的な手法である交差エントロピー損失関数を使用してトレーニングされます。
*   **L2正則化:** L2正則化は、モデルがトレーニングデータに過剰適合するのを防ぐために使用されます。
*   **メトリックプロット:** このモジュールは、トレーニングの過程における交差エントロピー損失、駒得係数、およびKPPの重みの最小/最大値のプロットを生成できます。

## 主要な関数

*   `main`: 自己対局学習プロセスのメインエントリポイントです。既存のモデルをロードし、自己対局を通じてトレーニングデータを生成し、モデルの重みを更新して、更新されたモデルを保存します。

## ヘルパー関数

*   `sigmoid`: 評価スコアを勝率に変換するために使用されるシグモイド関数です。
*   `update_weights`: 生成されたトレーニングデータに基づいてモデルの重みを更新します。
*   `position_from_sfen`: SFEN文字列から `Position` オブジェクトを作成します。
*   `plot_metrics`: トレーニングメトリックのプロットを生成します。